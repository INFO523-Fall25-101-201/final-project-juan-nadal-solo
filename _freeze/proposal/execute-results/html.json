{
  "hash": "a47ad6c220dd14181b03b16309e18fdf",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Are Movie Stars Worth Their Premiums?\"\nsubtitle: \"Project Proposal\"\nauthor:\n  - name: \"Juan Nadal\"\n    affiliations:\n      - name: \"College of Information Science, University of Arizona\"\ndescription: \"Analyzing whether expensive movie stars justify their pay premiums compared to other success factors using 1M+ movies from TMDB and IMDb datasets\"\nformat:\n  html:\n    code-tools: true\n    code-overflow: wrap\n    code-line-numbers: true\n    embed-resources: true\neditor: visual\ncode-annotations: hover\nexecute:\n  warning: false\njupyter: python3\n---\n\n::: {#load-pkgs .cell message='false' execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nimport pandas as pd\nimport psycopg2\nfrom dotenv import load_dotenv\nimport os\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Set visualization style\nsns.set_style(\"whitegrid\")\n```\n:::\n\n\n## Dataset\n\n::: {#cell-load-dataset .cell message='false' execution_count=2}\n``` {.python .cell-code}\n# Load environment variables and connect to database\nload_dotenv()\n\n# Database connection\nconn = psycopg2.connect(\n    host=os.getenv('DB_HOST'),\n    user=os.getenv('DB_USER'),\n    password=os.getenv('DB_PASSWORD'),\n    database=os.getenv('DB_DATABASE'),\n    port=os.getenv('DB_PORT')\n)\n\n# Load sample data for proposal\nquery = \"\"\"\nSELECT\n    m.id, m.title, m.release_date, m.budget, m.revenue,\n    m.vote_average, m.vote_count, m.popularity,\n    (m.revenue - m.budget) as profit,\n    CASE WHEN m.revenue > 0 THEN m.revenue::float / NULLIF(m.budget, 0) ELSE 0 END as roi\nFROM \"Movies_dataset\".movies m\nWHERE m.budget > 0 AND m.revenue > 0\nORDER BY m.revenue DESC\nLIMIT 1000\n\"\"\"\nfrom IPython.display import display\ndf_sample = pd.read_sql_query(query, conn)\nprint(f\"Loaded {len(df_sample):,} movies with complete financial data\")\nprint(f\"Database contains {df_sample['title'].nunique():,} unique titles\")\nprint(f\"\\nSample data:\")\npd.set_option('display.max_colwidth', None)\ndisplay(df_sample.head())\npd.reset_option('display.max_colwidth')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLoaded 1,000 movies with complete financial data\nDatabase contains 989 unique titles\n\nSample data:\n```\n:::\n\n::: {#load-dataset .cell-output .cell-output-display}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>id</th>\n      <th>title</th>\n      <th>release_date</th>\n      <th>budget</th>\n      <th>revenue</th>\n      <th>vote_average</th>\n      <th>vote_count</th>\n      <th>popularity</th>\n      <th>profit</th>\n      <th>roi</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>19995</td>\n      <td>Avatar</td>\n      <td>2009-12-10</td>\n      <td>237000000</td>\n      <td>2787965087</td>\n      <td>7.2</td>\n      <td>12114</td>\n      <td>185.070892</td>\n      <td>2550965087</td>\n      <td>11.763566</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>140607</td>\n      <td>Star Wars: The Force Awakens</td>\n      <td>2015-12-15</td>\n      <td>245000000</td>\n      <td>2068223624</td>\n      <td>7.5</td>\n      <td>7993</td>\n      <td>31.626013</td>\n      <td>1823223624</td>\n      <td>8.441729</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>597</td>\n      <td>Titanic</td>\n      <td>1997-11-18</td>\n      <td>200000000</td>\n      <td>1845034188</td>\n      <td>7.5</td>\n      <td>7770</td>\n      <td>26.889070</td>\n      <td>1645034188</td>\n      <td>9.225171</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>24428</td>\n      <td>The Avengers</td>\n      <td>2012-04-25</td>\n      <td>220000000</td>\n      <td>1519557910</td>\n      <td>7.4</td>\n      <td>12000</td>\n      <td>89.887648</td>\n      <td>1299557910</td>\n      <td>6.907081</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>135397</td>\n      <td>Jurassic World</td>\n      <td>2015-06-09</td>\n      <td>150000000</td>\n      <td>1513528810</td>\n      <td>6.5</td>\n      <td>8842</td>\n      <td>32.790475</td>\n      <td>1363528810</td>\n      <td>10.090192</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nThis project utilizes three comprehensive Kaggle datasets totaling approximately 770 MB:\n\n1. **TMDB Movies Daily Updates** (`alanvourch/tmdb-movies-daily-updates`): 960,000+ movies with regularly updated metadata including cast, crew, budgets, revenues, and release information (295.6 MB)\n\n2. **The Movies Dataset** (`rounakbanik/the-movies-dataset`): 45,000 movies with 26 million user ratings, providing detailed audience reception data and critical assessments (238.86 MB)\n\n3. **TMDB Movies Dataset 2023** (`asaniczka/tmdb-movies-dataset-2023-930k-movies`): 1 million movies with comprehensive feature data including genres, production companies, and streaming platform availability (238 MB)\n\nThese datasets were chosen because they provide the scale and diversity necessary to analyze movie success factors across different eras, genres, and markets. The combination of financial data (budgets, revenues), audience metrics (ratings, reviews), and metadata (cast, genres, platforms) enables a multi-faceted analysis of what truly drives movie success.\n\n::: {#dataset-statistics .cell message='false' execution_count=3}\n``` {.python .cell-code}\n# Get comprehensive dataset statistics\nstats_query = \"\"\"\nSELECT\n    COUNT(*) as total_movies,\n    COUNT(CASE WHEN budget > 0 AND revenue > 0 THEN 1 END) as movies_with_financials,\n    MIN(release_date) as earliest_movie,\n    MAX(release_date) as latest_movie,\n    AVG(CASE WHEN budget > 0 THEN budget END) as avg_budget,\n    AVG(CASE WHEN revenue > 0 THEN revenue END) as avg_revenue,\n    AVG(vote_average) as avg_rating\nFROM \"Movies_dataset\".movies\n\"\"\"\n\nstats = pd.read_sql_query(stats_query, conn)\nprint(\"Database Statistics:\")\nprint(f\"  Total movies: {stats['total_movies'].iloc[0]:,}\")\nprint(f\"  With financial data: {stats['movies_with_financials'].iloc[0]:,}\")\nprint(f\"  Date range: {stats['earliest_movie'].iloc[0]} to {stats['latest_movie'].iloc[0]}\")\nprint(f\"  Average budget: ${stats['avg_budget'].iloc[0]:,.0f}\")\nprint(f\"  Average revenue: ${stats['avg_revenue'].iloc[0]:,.0f}\")\nprint(f\"  Average rating: {stats['avg_rating'].iloc[0]:.2f}/10\")\n\n# Genre distribution\ngenre_query = \"\"\"\nSELECT g.name, COUNT(*) as movie_count\nFROM \"Movies_dataset\".genres g\nJOIN \"Movies_dataset\".movie_genres mg ON g.genre_id = mg.genre_id\nGROUP BY g.name\nORDER BY movie_count DESC\nLIMIT 10\n\"\"\"\n\ngenre_df = pd.read_sql_query(genre_query, conn)\nprint(f\"\\nTop 10 Genres by Movie Count:\")\nprint(genre_df.to_string(index=False))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDatabase Statistics:\n  Total movies: 45,433\n  With financial data: 5,375\n  Date range: 1874-12-09 to 2020-12-16\n  Average budget: $21,614,181\n  Average revenue: $68,856,627\n  Average rating: 5.62/10\n\nTop 10 Genres by Movie Count:\n           name  movie_count\n          Drama        20244\n         Comedy        13176\n       Thriller         7619\n        Romance         6730\n         Action         6592\n         Horror         4671\n          Crime         4304\n    Documentary         3930\n      Adventure         3490\nScience Fiction         3044\n```\n:::\n:::\n\n\n::: {#cell-fig-budget-revenue .cell execution_count=4}\n``` {.python .cell-code}\nplt.figure(figsize=(8, 8))\nplt.scatter(df_sample['budget'] / 1e6, df_sample['revenue'] / 1e6, alpha=0.6, s=50)\nplt.xlabel('Budget (millions USD)')\nplt.ylabel('Revenue (millions USD)')\nplt.title('Movie Budget vs Revenue')\nplt.grid(True, alpha=0.3)\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Relationship between budget and revenue for top 1000 highest-grossing movies](proposal_files/figure-html/fig-budget-revenue-output-1.png){#fig-budget-revenue width=759 height=757}\n:::\n:::\n\n\n## Questions\n\n1. **Do expensive movie stars justify their pay premiums?** Specifically, does the presence of high-profile actors correlate with higher box office revenue and better audience ratings when controlling for other factors like budget, genre, and release timing?\n\n2. **Which factors most reliably predict movie success?** Between star power, genre, release timing (summer blockbusters vs. other periods), sequel status, and streaming platform presence, which variables have the strongest predictive power for financial and critical success?\n\n## Analysis plan\n\n**Question 1: Star Power Premium Analysis**\n\n- **Variables involved**: Actor prominence scores, cast budgets, box office revenue, profitability ratios, audience ratings\n- **Variables to create**:\n  - Star power index (combining cast prominence, awards history, previous box office performance)\n  - Premium ratio (actual revenue vs. predicted revenue based on non-star factors)\n  - Cost-effectiveness metric (revenue per dollar spent on cast)\n- **Approach**: Multiple regression analysis comparing movies with high-profile casts vs. comparable films with lesser-known actors, controlling for budget, genre, and release timing\n\n**Question 2: Predictive Modeling of Success**\n\n- **Variables involved**: Genre classifications, release month/season, franchise status, budget tiers, cast prominence, production company\n- **Variables to create**:\n  - Seasonal release categories (summer blockbuster, holiday, off-season)\n\n",
    "supporting": [
      "proposal_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}